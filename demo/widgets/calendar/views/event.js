define(["sandbox"],function(e){"use strict";var t=e.mvc.View({initialize:function(){e.events.bindAll(this)},render:function(){var t={Ok:this.save};return this.model.isNew()||e.util.extend(t,{Delete:this.destroy}),e.util.extend(t,{Cancel:this.close}),this.$el.dialog({modal:!0,title:(this.model.isNew()?"New":"Edit")+" Event",buttons:t,open:this.open}),this},open:function(){this.$("#title").val(this.model.get("title")),this.$("#color").val(this.model.get("color"))},save:function(){this.model.set({title:this.$("#title").val(),color:this.$("#color").val()}),this.model.isNew()?this.collection.create(this.model,{success:this.saved}):this.model.save({},{success:this.modelSaved})},modelSaved:function(e){this.collection.trigger("event-modified",e),this.close()},saved:function(e){this.collection._byId[e.id]=e,this.collection.trigger("event-added",e),this.close()},close:function(e){this.$el.dialog("close")},destroy:function(){this.model.destroy({success:this.close})}});return t});